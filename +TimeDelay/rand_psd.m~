function F_w=rand_psd(VarOmega,varargin)
% Generate a complex random frequency realization with real ifft.
% Package: +TimeDelay
% Description: 
% Input  : * Arbitrary number of pairs of ...,key,val,... arguments.
%            The following keywords are available:
%            
% Output : - 
% License: GNU general public license version 3
%     By : Eran O. Ofek                    Feb 2020
%    URL : http://weizmann.ac.il/home/eofek/matlab/
% Example: LC=TimeDelay.random_lc
%          TR=timeseries.random_time_sequence(700,1,250,0,0.8);
%          LC=TimeDelay.random_lc('Time',TR);
% Reliable: 2
%--------------------------------------------------------------------------

InPar = inputParser;

addOptional(InPar,'Time',731);
addOptional(InPar,'gamma',2);
addOptional(InPar,'A0',0);
addOptional(InPar,'A',[1 2./3]);
addOptional(InPar,'TimeDelay',[0 14.7]);
addOptional(InPar,'fDC',7);
addOptional(InPar,'Err',0.03);
addOptional(InPar,'SampT',1);
addOptional(InPar,'InterpMethod','linear');

parse(InPar,varargin{:});

N   = numel(VarOmega);
FN2 = floor(N./2);
F_w = zeros(N,1);
Freq = (2:1:2+FN2);
F_w(Freq) = randn(FN2,1).*VarOmega(Freq).^0.5./sqrt(2);
F_w(Freq) = F_w(Freq) + 1i.*randn(N./2,1).*VarOmega(Freq).^0.5./sqrt(2);
F_w(floor( (2+N)./2 ):end) = flipud(conj(F_w(Freq)));